<structure collectionName="productSubscriptionInstancePeriods" comment="A single instance will need multiple payments over time to stay active.&#10;Additionally commercial gestures like first month free or whatever can be added to activate an instance&#10;&#10;If during an active period you want to buy additional units, we add a new period.&#10;If you want historically accurate prices, you can check the payment order. Alternatively use the &quot;current&quot; subscription prices.&#10;&#10;For automatic renewal, we assume you likely want the current production subscription level prices.&#10;Again, you can alternatively check the historic prices in order. Or you can make a calculation based on that (e.g. indexing)" name="productSubscriptionInstancePeriod">
    <field name="id" pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}|[0-9a-fA-F]{32}" primaryKey="true" type="java.util.UUID"/>
    <field foreignKey="nabu.cms.payment.database.types.productSubscriptionInstance:id" name="productSubscriptionInstanceId" pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}|[0-9a-fA-F]{32}" type="java.util.UUID"/>
    <field name="created" timezone="UTC" type="java.util.Date"/>
    <field comment="Only activated periods are relevant. A period is activated for example when a payment is received." minOccurs="0" name="activated" timezone="UTC" type="java.util.Date"/>
    <field comment="The start of the period." minOccurs="0" name="started" timezone="UTC" type="java.util.Date"/>
    <field comment="The end of the period" minOccurs="0" name="stopped" timezone="UTC" type="java.util.Date"/>
    <field comment="The amount of units you have activated for this period. You can have overlapping periods (by buying new while a period is already active)." name="unitAmount" type="java.lang.Long"/>
    <field comment="If an actual payment was done, we link it" foreignKey="nabu.cms.payment.database.types.paymentOrderEntry:id" minOccurs="0" name="paymentOrderEntryId" pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}|[0-9a-fA-F]{32}" type="java.util.UUID"/>
    <field comment="We need to know the level so we can check the latest prices. If a subscription instance has multiple active periods with DIFFERENT levels, the LATEST period is the current active level" foreignKey="nabu.cms.payment.database.types.productSubscriptionLevel:id" minOccurs="0" name="productSubscriptionLevelId" pattern="[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}|[0-9a-fA-F]{32}" type="java.util.UUID"/>
</structure>
